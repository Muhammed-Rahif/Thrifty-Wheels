{{!-- stylesheets --}}
<link href="/stylesheets/style1.css" rel="stylesheet" type="text/css">
<link href="/stylesheets/style2.css" rel="stylesheet" type="text/css">
<link href="/stylesheets/style3.css" rel="stylesheet" type="text/css">
<link href="/stylesheets/view-post-page.css" rel="stylesheet" type="text/css">
{{!-- For rating stars --}}
<style>
    .checked {
        color: orange;
    }
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="navbar-wrapper-fixed">
    <div data-collapse="medium" data-animation="over-right" data-duration="400" data-no-scroll="1" data-doc-height="1"
        class="navbar w-nav">
        <div class="container w-container"><a href="/" class="logo-link-block align-left w-nav-brand">
                <h1 class="brand poppins"><span class="fname poppins">Thrifty</span> Wheels</h1>
            </a>
            <nav role="navigation" class="nav-menu w-nav-menu poppins"><a href="/"
                    class="nav-link w-nav-link">Home</a><a href="/about" class="nav-link w-nav-link poppins">About</a>
            </nav>
            <div class="menu-button w-nav-button">
                <div class="w-icon-nav-menu"></div>
            </div>
        </div>
    </div>
</div>

<div class="dynamic-page-header"
    style="background-image: url('/gallery/post-images/{{postDet.postId}}.jpg') !important;">
    <div data-w-id="fb504413-d5b4-3ca2-7c6c-2e8872f7d460" class="dynamic-header-overlay">
        <div class="container w-container">
            <div class="header-content-block">
                <div style="background-image: url('/gallery/post-images/{{postDet.postId}}.jpg') !important;-webkit-transform:translate3d(-20PX, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-moz-transform:translate3d(-20PX, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-ms-transform:translate3d(-20PX, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);transform:translate3d(-20PX, 0, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);opacity:1"
                    class="header-thumbnail-image">
                    <!--<div style="-webkit-transform:translate3d(0, 0, 0) scale3d(0.5, 0.5, 1) rotateX(0) rotateY(0) rotateZ(60DEG) skew(0, 0);-moz-transform:translate3d(0, 0, 0) scale3d(0.5, 0.5, 1) rotateX(0) rotateY(0) rotateZ(60DEG) skew(0, 0);-ms-transform:translate3d(0, 0, 0) scale3d(0.5, 0.5, 1) rotateX(0) rotateY(0) rotateZ(60DEG) skew(0, 0);transform:translate3d(0, 0, 0) scale3d(0.5, 0.5, 1) rotateX(0) rotateY(0) rotateZ(60DEG) skew(0, 0);opacity:0" class="review-circle">
              <div class="review-circle-title"></div>
            </div>-->
                </div>
                <h1 class="header-title">{{postDet.mainTitle}}</h1>
                <div class="header-info-block">
                    <div class="header-info-item poppins">
                        <div class="header-info-title bold">Full name of vehicle : {{postDet.vehicleName}}</div>
                        <div class="header-info-title">Posted Date : {{postDet.postDate}}</div>
                    </div>
                </div>
                <!-- <div class="info-wrapper on-review-page">
                    <div class="info-block mobile-full"><img src="" alt="" class="info-block-icon stars-large"></div>
            <div class="info-block"><img src="images/tag.svg" alt="" class="info-block-icon"><a href="#" class="info-title-link"></a></div>
            <div class="info-block"><img src="images/clock.svg" alt="" class="info-block-icon">
              <div class="info-title"></div>
            </div>
                </div>-->
                <p class="header-short-description poppins">{{postDet.postDiscription}}</p>
                <img style="width: 7em;height: auto;margin-top: 1em;" class="info-block-icon stars"
                    src="/gallery/stars-png/{{postDet.starRating}}.png" alt="">
            </div>
        </div>
    </div>
</div>

<div class="review-section">
    <div class="inner-review">
        <div class="post-review-section">
            <div class="review-header">
                <h4>Post a review..!</h4>
            </div>
            <hr style="max-width: 18vw;background: white;">
            <div class="input-area">
                <textarea name="userReview" id="reviewArea" rows="10" placeholder="Type your review here..!"></textarea>
            </div>
            <div class="submit-area">
                <button class="btn" onclick="postReview();">Post review!</button>
            </div>
        </div>
        <div class="reviews-section">
            <div class="user-review">
                <div class="review-header">
                    <h4 style="margin-top: 3em;">Posted reviews..</h4>
                </div>
                <hr style="max-width: 18vw;background: white;margin-bottom: 3em;">
                <div style="margin-bottom: 3em;" class="reviews-area">
                    {{#if allReviews}}
                    {{#each allReviews}}
                    <div class="content-area">
                        <div class="user-det">
                            <p>{{this.user}} : </p>
                        </div>
                        <div class="text-area">
                            <p style="max-width: 75vw;">{{this.userReview}}</p>
                        </div>
                    </div>
                    <hr style="max-width: 4vw;background: white;margin-bottom: 1em;margin-top: 1em;opacity: .25;">
                    {{/each}}
                    {{else}}
                    <hr style="max-width: 18vw;background: white;">
                    <p style="color: white;text-align: center;">No reviews found..!</p>
                </div>
                {{/if}}
            </div>
        </div>
    </div>
</div>
<script>
    function postReview() {
        let userReview = $('#reviewArea').val();
        if (userReview === "" || userReview === null) {
            alert('Type something in review box and submit..!')
        } else {
            $.ajax({
                url: "/post-review",
                data: {
                    userReview: userReview,
                    postId: '{{postDet.postId}}',
                    user: '_USERDATA_'
                },
                method: 'post',
                success: function (response) {
                    if (response.status) {
                        $('#reviewArea').val(null);
                        alert(`Post added successfully.!`);
                        getPostReviews();
                    } else {
                        alert('Something went wrong..!');
                    }
                }
            });
        }
    }


    function getPostReviews() {
        $.ajax({
            url: "/get-post-reviews",
            data: {
                postId: '{{postDet.postId}}'
            },
            method: 'post',
            success: function (allReviews) {
                $('.reviews-area').empty();
                allReviews.forEach((itm, key) => {
                    $('.reviews-area').append(`
                        <div class="content-area">
                        <div class="user-det">
                            <p>${itm.user} : </p>
                        </div>
                        <div class="text-area">
                            <p style="max-width: 75vw;">${itm.userReview}</p>
                        </div>
                        </div>
                        <hr style="max-width: 4vw;background: white;margin-bottom: 1em;margin-top: 1em;opacity: .25;">
                    `)
                })
            }
        });
    }
</script>
<script src="/js/javascript.js" type="text/javascript"></script>